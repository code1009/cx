/////////////////////////////////////////////////////////////////////////////
//===========================================================================
#include "pch.hpp"

//===========================================================================
#include "runtime.hpp"

//===========================================================================
#include "../gw/DirectX2dGraphic.hpp"





/////////////////////////////////////////////////////////////////////////////
//===========================================================================
namespace cx::runtime
{





/////////////////////////////////////////////////////////////////////////////
//===========================================================================
bool WindowApplication::initialize(void)
{
	//-----------------------------------------------------------------------
	HRESULT hr;


	hr = OleInitialize(nullptr);
	if (FAILED(hr))
	{
		return false;
	}


	//-----------------------------------------------------------------------
	if (gw::DirectX2dGraphic::createFactory() == false)
	{
		::OleUninitialize();

		return false;
	}


	//-----------------------------------------------------------------------
	_DebugMemory.enableMemoryCheck();
	_DebugMemory.startMemoryLeakCheck();


	return true;
}

void WindowApplication::terminate(void)
{
	//-----------------------------------------------------------------------
	_DebugMemory.endMemoryLeakCheck();


	//-----------------------------------------------------------------------
	gw::DirectX2dGraphic::destroyFactory();


	//-----------------------------------------------------------------------
	::OleUninitialize();
}




/////////////////////////////////////////////////////////////////////////////
//===========================================================================
}

