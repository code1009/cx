/////////////////////////////////////////////////////////////////////////////
//===========================================================================
#include "pch.hpp"
#include "cx-rpn-fsm.hpp"





/////////////////////////////////////////////////////////////////////////////
//===========================================================================
namespace cx::rpn::fsm
{





/////////////////////////////////////////////////////////////////////////////
//
// Class: event
//
/////////////////////////////////////////////////////////////////////////////
//===========================================================================
void event::notify (machine* m, state* s)
{
	if (s)
	{
		s->on_event (m, this);
	}
}



/////////////////////////////////////////////////////////////////////////////
//
// Class: state
//
/////////////////////////////////////////////////////////////////////////////
//===========================================================================
void state::on_entry (machine*, state*) {}
void state::on_exit  (machine*, state*) {}
void state::on_event (machine*, event*) {}

//===========================================================================
void state::transition (machine* m, state* s)
{
	if (m)
	{
		m->transition (s);
	}
}



/////////////////////////////////////////////////////////////////////////////
//
// Class: machine
//
/////////////////////////////////////////////////////////////////////////////
//===========================================================================
state* machine::get_state (void) const
{
	return _state;
}

//===========================================================================
void machine::transition (state* current)
{	
	state* previous;

	previous = _state;
	if (previous)
	{
		previous->on_exit (this, current );
	}

	_state = current;
	if (current)
	{
		current ->on_entry (this, previous);
	}
}

void machine::notify (event* e)
{
	if (e)
	{
		e->notify (this, _state);
	}
}





/////////////////////////////////////////////////////////////////////////////
//===========================================================================
}



